browseVignettes("highcharter")
l <- c("A", "E", "K", "S", "R", "Q", "L", "T", "N", "G", "M", "W", "D", "H", "F", "Y", "C", "I", "P", "V")
set.seed(42)
sequences <- sapply(sample(10:100, 500, replace = TRUE), function(x) paste(sample(l, x, replace = TRUE), collapse = ""))
head(sequences)
labels <- c(rep(1, 200), rep(0, 300))
pattern <- 1:4
pattern <- lapply(pattern, function(x) c("S", "R", ""))
pattern <- expand.grid(pattern, stringsAsFactors = FALSE)
pattern <- sort(apply(pattern, 1, function(x) paste(x, collapse = "")))
# randomly introduce pattern in first 200 sequences
sequences[1:200] <- sapply(sequences[1:200], function(x) {
pat <- sort(sample.int(nchar(x), sample.int(nchar(x) - 1, 1) + 1))
paste0(substring(x, pat[-length(pat)], pat[-1] - 1),
sample(pattern, length(pat) - 1, replace = TRUE), collapse = "")
})
library(RBDpredict)
model <- RBDfit(sequences, labels)
model
err <- CV(model)
ROCplot(err)
plot(err)
PRplot(err, FDR = 0.1)
newseq <- sapply(sample(10:100, 1000, replace = TRUE), function(x) paste(sample(l, x, replace = TRUE), collapse = ""))
newseq[1:400] <- sapply(newseq[1:400], function(x) {
pat <- sort(sample.int(nchar(x), sample.int(nchar(x) - 1, 1) + 1))
paste0(substring(x, pat[-length(pat)], pat[-1] - 1),
sample(pattern, length(pat) - 1, replace = TRUE), collapse = "")
})
pred <- predict(model, err, seq = newseq, FDR = 0.1)
pred
newlab <- pred$RBDclass
TP <- sum(newlab[1:400])
FP <- sum(newlab[401:1000])
TN <- sum(newlab[1:400] == 0)
FN <- sum(newlab[400:1000] == 0)
(FPR <- FP / (FP + TP))
(sens <- TP / (TP + FN))
