browseVignettes("highcharter")
l <- c("A", "E", "K", "S", "R", "Q", "L", "T", "N", "G", "M", "W", "D", "H", "F", "Y", "C", "I", "P", "V")
set.seed(42)
sequences <- sapply(sample(10:100, 500, replace = TRUE), function(x) paste(sample(l, x, replace = TRUE), collapse = ""))
head(sequences)
labels <- c(rep(1, 200), rep(0, 300))
pattern <- 1:4
pattern <- lapply(pattern, function(x) c("S", "R", ""))
pattern <- expand.grid(pattern, stringsAsFactors = FALSE)
pattern <- sort(apply(pattern, 1, function(x) paste(x, collapse = "")))
# randomly introduce pattern in first 200 sequences
sequences[1:200] <- sapply(sequences[1:200], function(x) {
pat <- sort(sample.int(nchar(x), sample.int(nchar(x) - 1, 1) + 1))
paste0(substring(x, pat[-length(pat)], pat[-1] - 1),
sample(pattern, length(pat) - 1, replace = TRUE), collapse = "")
})
library(RBDpredict)
model <- RBDfit(sequences, labels)
model
err <- CV(model)
ROCplot(err)
plot(err)
PRplot(err, FDR = 0.1)
newseq <- sapply(sample(10:100, 1000, replace = TRUE), function(x) paste(sample(l, x, replace = TRUE), collapse = ""))
newseq[1:400] <- sapply(newseq[1:400], function(x) {
pat <- sort(sample.int(nchar(x), sample.int(nchar(x) - 1, 1) + 1))
paste0(substring(x, pat[-length(pat)], pat[-1] - 1),
sample(pattern, length(pat) - 1, replace = TRUE), collapse = "")
})
pred <- predict(model, err, seq = newseq, FDR = 0.1)
pred
newlab <- pred$RBDclass
TP <- sum(newlab[1:400])
FP <- sum(newlab[401:1000])
TN <- sum(newlab[1:400] == 0)
FN <- sum(newlab[400:1000] == 0)
(FPR <- FP / (FP + TP))
(sens <- TP / (TP + FN))
list("a" = 1:10, 100 = 1:5)
list("a" = 1:10, "100" = 1:5)
setwd("../R")
source("Err.R")
source("GetKMers.R")
source("RBDfit.R")
source("cvRBDfit.R")
source("predict.RBDmodel.R")
source("ROCplot.R")
source("PRplot.R")
source("addErr.R")
source("plot.R")
source("print.R")
l <- c("A", "E", "K", "S", "R", "Q", "L", "T", "N", "G", "M", "W", "D", "H", "F", "Y", "C", "I", "P", "V")
sequences <- sapply(sample(10:100, 500, replace = TRUE), function(x) paste(sample(l, x, replace = TRUE), collapse = ""))
labels <- c(rep(1, 200), rep(0, 300))
model <- RBDfit(sequences, labels, k = 2)
str(model)
model
plot(model)
rm(l, labels, model, sequences)
l <- c("A", "E", "K", "S", "R", "Q", "L", "T", "N", "G", "M", "W", "D", "H", "F", "Y", "C", "I", "P", "V")
sequences <- sapply(sample(10:100, 500, replace = TRUE), function(x) paste(sample(l, x, replace = TRUE), collapse = ""))
labels <- c(rep(1, 200), rep(0, 300))
model <- RBDfit(sequences, labels, k = 2)
err <- cvRBDfit(model, nfold = 3)
err <- cvRBDfit(model, sequences, labels, nfold = 3)
str(err)
err
plotROC(err)
ROCplot(err, sens = 0.5)
plot(err)
model <- addErr(model, err)
str(model)
model
print.RBDmodel <- function(o){
cat("RBDmodel with", nrow(o$RBDfeatureExtraction), "sequences and labels\n")
cat("Called with n =", o$RBDparams$n, ", k =", o$RBDparams$k," resulting in", o$RBDparams$feats, "features\n\n")
cat("Resulting Model:\n\n")
cat("regularization:\n")
print(o$RBDmodel$regularization)
cat("\nfrequencies:\n")
print(o$RBDmodel$freqs)
cat("\nalpha:\n")
print(o$RBDmodel$alpha)
cat("\nbeta:\n")
str(o$RBDmodel$beta)
if(!is.null(o$RBDerr)) cat("\nPrediction Error Estimate by", o$RBDparams$nfold, "fold Cross Validation included\n")
}
model
plot(model)
newseq <- sapply(sample(10:100, 500, replace = TRUE), function(x) paste(sample(l, x, replace = TRUE), collapse = ""))
pred <- predict(model, newseq, sens = 0.5)
pred
plot(pred)
ROCplot(err, sens = 0.5)
d <- ROCplot(err, data = TRUE)
summary(d)
plot(d$fal, d$rec)
err2 <- cvRBDfit(model, sequences, labels, nfold = 5)
err <- list("3fold" = err, "5fold" = err2)
ROCplot(err, legend = "cross validation", sens = 0.5)
err <- cvRBDfit(model, sequences, labels, nfold = 3)
PRplot(err, FDR = 0.5)
PRplot(err, FDR = 0.4)
PRplot(err, sens = 0.5)
d <- PRplot(err, data = TRUE)
summary(d)
plot(d$pre, d$rec)
err2 <- cvRBDfit(model, sequences, labels, nfold = 5)
err <- list("3fold" = err, "5fold" = err2)
PRplot(err, legend = "cross validation", sens = 0.5)
source("ROCplot.R")
library(RBDpredict)
l <- c("A", "E", "K", "S", "R", "Q", "L", "T", "N", "G", "M", "W", "D", "H", "F", "Y", "C", "I", "P", "V")
# create array
set.seed(42)
sequences <- sapply(sample(10:100, 500, replace = TRUE), function(x) paste(sample(l, x, replace = TRUE), collapse = ""))
head(sequences)
labels <- c(rep(1, 200), rep(0, 300))
pattern <- 1:4
pattern <- lapply(pattern, function(x) c("S", "R", ""))
pattern <- expand.grid(pattern, stringsAsFactors = FALSE)
pattern <- sort(apply(pattern, 1, function(x) paste(x, collapse = "")))
# randomly introduce pattern in first 200 sequences
sequences[1:200] <- sapply(sequences[1:200], function(x) {
pat <- sort(sample.int(nchar(x), sample.int(nchar(x) - 1, 1) + 1))
paste0(substring(x, pat[-length(pat)], pat[-1] - 1), sample(pattern, length(pat) - 1, replace = TRUE), collapse = "")
})
newseq <- sapply(sample(10:100, 1000, replace = TRUE), function(x) paste(sample(l, x, replace = TRUE), collapse = ""))
newseq[1:400] <- sapply(newseq[1:400], function(x) {
pat <- sort(sample.int(nchar(x), sample.int(nchar(x) - 1, 1) + 1))
paste0(substring(x, pat[-length(pat)], pat[-1] - 1),
sample(pattern, length(pat) - 1, replace = TRUE), collapse = "")
})
model1 <- RBDfit(sequences, labels)
model2 <- RBDfit(sequences, labels, n = 100)
source("ROCplot.R")
df <- ROCplot(list(err1, err2), data = TRUE)
err1 <- cvRBDfit(model1, sequences, labels)
err2 <- cvRBDfit(model2, sequences, labels)
source("ROCplot.R")
df <- ROCplot(list(err1, err2), data = TRUE)
df <- ROCplot(list(err1, err2), data = TRUE, names = c("a", "b"))
source("ROCplot.R")
df <- ROCplot(list(err1, err2), data = TRUE, names = c("a", "b"))
df
source("ROCplot.R")
df <- ROCplot(list(err1, err2), data = TRUE, names = NULL)
df <- ROCplot(list(err1, err2), data = TRUE, names = 1:3)
df <- ROCplot(list(err1, err2), data = TRUE, names = 1:2)
df
ROCplot(list(err1, err2), data = TRUE, names = 1:2)
ROCplot(list(err1, err2), names = 1:2)
source("ROCplot.R")
ROCplot(list(err1, err2), names = 1:2)
ROCplot(list(err1, err2), names = c("a", "b"))
ROCplot(list(err1, err2), names = c("a", "b"), title = NULL)
ROCplot(list(err1, err2), names = c("a", "b"), title = "asd")
ROCplot(list(err1, err2), names = c("a", "b"), title = "asd", sens = 0.5)
ROCplot(list(err1, err2), names = c("a", "b"), title = NULL, sens = 0.5)
ROCplot(list(err1, err2), names = c("a", "b"), title = NULL)
ROCplot(list(err1, err2), names = c("a", "b"), title = NULL, sens = 0.5)
ROCplot(list(err1, err2), names = c("a", "b"), title = NULL, sens = 0.5, legend = NULL)
ROCplot(list(err1, err2), names = c("a", "b"), title = NULL, sens = 0.5, legend = "")
source("ROCplot.R")
ROCplot(list(err1, err2), names = c("a", "b"), title = NULL, sens = 0.5, legend = "")
ROCplot(list(err1, err2), names = c("a", "b"), title = NULL, sens = 0.5, legend = NULL)
ROCplot(list(err1, err2), names = c("a", "b"), title = "some title", sens = 0.5, legend = "legend")
ROCplot(err1, names = c("a", "b"), title = "some title", sens = 0.5, legend = "legend")
class(err1)
source("ROCplot.R")
ROCplot(err1, names = c("a", "b"), title = "some title", sens = 0.5, legend = "legend")
ROCplot(err2, names = c("a", "b"), title = "some title", sens = 0.5, legend = "legend")
ROCplot(list(err1, err2), names = c("a", "b"), title = "some title", sens = 0.5, legend = "legend")
source("ROCplot.R")
ROCplot(list(err1, err2), names = c("a", "b"), title = "some title", sens = 0.5, legend = "legend")
ROCplot(list(err1, err2), names = 1:2, title = "some title", sens = 0.5, legend = "legend")
ROCplot(err1, names = 1:2, title = "some title", sens = 0.5, legend = "legend")
ROCplot(err1, names = 1:2, title = "some title", sens = 0.5, legend = NULL)
ROCplot(err1, names = 1:2, title = "some title", sens = 0.5, legend = "NULL")
ROCplot(err1, names = 1:2, title = NULL, sens = 0.5, legend = "NULL")
ROCplot(list(err1, err2), names = 1:2, title = NULL, sens = 0.5, legend = "NULL")
source("PRplot.R")
PRplot(list(err1, err2), names = 1:2, title = NULL, sens = 0.5, legend = "NULL")
source("PRplot.R")
PRplot(list(err1, err2), names = 1:2, title = NULL, sens = 0.5, legend = "NULL")
rm(PRplot)
PRplot(err1)
source("PRplot.R")
PRplot(list(err1, err2), names = 1:2, title = NULL, sens = 0.5, legend = "NULL")
PRplot(list(err1, err2), names = c("a", "b"), title = NULL, sens = 0.5, legend = "NULL")
PRplot(list(err1, err2), names = c("a"), title = NULL, sens = 0.5, legend = "NULL")
PRplot(list(err1, err2), names = NULL, title = NULL, sens = 0.5, legend = "NULL")
PRplot(list(err1, err2), names = "", title = NULL, sens = 0.5, legend = "NULL")
PRplot(list(err1, err2), names = NA, title = NULL, sens = 0.5, legend = "NULL")
PRplot(list(err1, err2), names = c("a", "b"), title = NULL, sens = 0.5, legend = "NULL")
PRplot(list(err1, err2), names = c("a", "b"), title = NULL, sens = 0.5, legend = NULL)
PRplot(list(err1, err2), names = c("a", "b"), title = NULL, sens = 0.5)
PRplot(list(err1, err2), names = c("a", "b"), title = NULL, FDR = 0.5)
PRplot(err1, names = c("a", "b"), title = NULL, FDR = 0.5)
PRplot(err1, names = c("a", "b"), title = "NULL", FDR = 0.5)
PRplot(err1, names = c("a", "b"), FDR = 0.5)
PRplot(err1, names = c("1", "2"), FDR = 0.5)
PRplot(list(err1, err2), names = c("1", "2"), FDR = 0.5)
PRplot(list(err1, err2), names = c("Q1", "2"), FDR = 0.5)
